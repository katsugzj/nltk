<DOC>
<DOCNO>  ZF109-714-901  <DOCNO>
<TEXT>
find your file window 3.0 winwher most like 've alreadi delight improv microsoft achiev separ program manag file manag window 3.0. P you start program manag applic simpli double-click icon add delet chang icon ease. P you organ program frequent use conveni group rather wave way disk directori structur find them. P you even jump-start data file whose extens associ particular applic extens section win.ini. M but program manag object-ori feel new file manag though advanc file manag portion ms-do execut still look like windows version tradit do shell utility. P one glare defici lack file finder need becam obviou recent visit PC magazine. M A larg organ us window 3.0 may mani differ server network. P thu addit physic ram drive typic user may mani differ remot directori map logic drive system. P A PC magazin staffer exampl might 20 differ logic drives. P how find particular file within window 3.0 session P there 's way hand-navig subdirectori everi logic drive system perform visual search desir file P winwher file-find util written specif window 3.0 elimin product roadblock. M winwher let choos file specif select one drive search. P your file specif either complet filenam one contain standard wildcards. P you limit search file date size. P all filenam match search criterion display scrollabl list box. P As bonu winwher give option automat gener batch file contain command file select form list box. M you download ready-to-run copi winwhere.ex PC magnet. P simpli follow instruct given sidebar winwher modem M If wish make modif program also want download C sourc code associ files. P In order recompil program requir window version 3.0 softwar develop kit sdk C compil capbl gener window code microsoft C 5.1 later P you must make certain window includ file store directori specifi includ environ variable. P also make sure window librari directori specifi lib environ variable. P then use make.ex util come microsoft C 5.1 abl recompil simpli issu command M make winwher M use winwher M onc winwher disk 'll want add program manag group. P So start window click mous program group would like put winwhere. P I chose window applic group system P select file/new menu item main menu bar enter absolut pathnam winwher press OK button. P the winwher icon ad program group run simpli double-click mous icon. M winwher leaner look window applications. P In place usual main overlap window menu bar winwher bring singl main dialog box shown figur 1. P A program like winwher n't need lot differ command 's need menu bar. P sinc user interact dialog box noth need display encompass frame window 's need man window either. P you simpli fill appropri field dialog box click OK button. M mani user number common file specif use repeatedly. O for exampl might often wish search simpli pagemak xywrit files. P To elimin need re-ent frequent use filespec winwher provid combin box let list file type put associ file specif file name field directly. O the file specif associ default anyth file type would want exampl associ *.pm3 specif pagemak files. M you add identifi file type specif combin box clike add file push button. P thi bring dialog box shown figur 2. P after enter necessari inform two edit field click OK button file type automat ad combin box. P the entir list file type/specif pair save win.ini file exit winwher alway come custom set file types. M have enter select desir file specif select one drive searched. P all drive system includ logic network drive ram drive list multiple-select list box simpli click appropri letter P the default make select current drive directori subdirectori any. M winwher also let search file whose size greater le equal specifi number. P just click By size check box enter size adjoin edit field comma abbrevi allow click one three radio button design desir comparison. P note the edit field radio button disabl By size check box toggl on. P A similar procedur let match file creat last modifi later earlier date specify. M onc chosen file specif disk drive search search criterion need push OK button commenc search operation. P the complet pathnam file satisfi criterion appear found file list box. O when search oper complet use cursor key mous read list files. M As final option winwher provid way gener batch file contain singl command everi file select present found file list box. P you might exampl want copi found file diskette. P To press find option push button. P A dialog box contain two edit field multipl select listbox pop up. P the edit field prompt filenam want use batch file rememb includ .bat extens command given select file. P the multipl select list box contain copi entir list found files. P default file list box automat selected. P To deselect file simpli click mous name file. M In enter command string constitut batch file must use exclam point filenam substituted. P for exampl enter command copi file A drive would enter string. M copi M If select file letter.pm3 recipe.pm3 foobaz.doc batch file gener winwher would consist follow line M copi letter.pm3 copi recipe.pm3 copi foobaz.doc M you also navig winwher use keyboard. P press tab move clockwis field field shft-tab move counter-clockwise. O To make select list box exampl drive list box simpli hit spacebar. P onc enter inform field make select press tab move next field press enter execut search. O onc 've specifi search criterion tab OK button press enter. M that 's use winwher P now let 's examin inner work program see code window environment. M understand winwher M when write window program C entri point user-written function call winmain P most window program begin execut regist variou window class window applic us includ class main window. P the applic normal creat display main window go standard window message-process loop. M winwher none this. P instead directli load main dialog box binari resourc inform tack onto end everi window applic 's .ex file. P It call dialogbox function. O dialogbox load display dialog box go intern message-process loop monitor messag sent dialog box. M the dialogbox function creat modal dialog box. P with modal dialog box user must explicitli dismiss dialog box interact window application. P the user dismiss modal dialog box click mous OK cancel push button. P A le frequent encount type dialog box modeless dialog box. P with modeless dialog box user switch input focu dialog box anoth window applic time. P the pif editor window window modeless dialog box. M everi dialog box must call function handl messag flow window dialog box. P thi function allow window applic process messag dialog box manag does. P figur 3 show diagram process surround modal dialog box. P the dialog box function winwher 's main dialog box call wheredlgproc look almost like normal window procedure. P notic howev dialog box function must return 1-byte bool valu rather 4-byte long valu return window procedure. P the dialog box function return true process messag return fals dialog box manag process messag instead. M the first messag alway sent window dialog box wn_init-dialog message. P It give programm chanc initi variou control dialog box dialog box actual displayed. P sinc minim winwher 's main dialog box first want associ icon it. M when window minim window hide window display icon place. P the icon display usual associ window class programm regist class. P the programm load icon program obtain handl icon. P the handl place wndclass structur use regist window class P but sinc class registr code winwher associ icon dialog box P how winwher dialog box come belong window class M window predefin window class dialog box belong. P you verifi use spi program come window sdk examin structur typic dialog box. P the singl line code associ icon dialog box M setclassword hdlg gcw_hicon loadicon hinst winwher M We use loadicon load specifi icon .ex file. P thi function return handl load icon. P To place handl icon window class data structur call setclassword gcw_hicon second argument handl load icon third argument. P the line code associ load icon everi dialog box winwher creates. P thi may ideal procedur sinc winwher us one minimiz dialog box get away it. M A second task perform dialog box initi process load string contain custom list file-type/file-specif pairings. P these store one long string win.ini file typifi four pair line follow M winwher filetyp = anyth document *.doc pagemak *.pm3 xywrit *.xyw M We load string win.ini file use window function getprofilestr P when start winwher first time anyth pair place combin box. P It 's add entri own. M the current implement winwher delet edit file-type/file-specif pair stored. P you howev use ordinari ascii text editor edit win.ini file. O simpli search winwher section edit specif string yourself. P rememb leav blank file type correspond specification. P inde could edit win.ini file within window use sysedit program come windows. P note window preinstal sysedit program program manag first instal windows. P you howev use file/new menu choic instal one program group M the final thing must initi code get name disk drive system insert drive list box. O thi done send lb_dir messag drive list box use suitabl valu wparam paramet M senddlgitemmessag hdlg id_drivelist lb_dir 0xc000 long lpstr M ~~~.~~~ the 0xc000 valu wparam inform window want exclus search drives. P unfortun left devic window automat search normal file well drive thu put name file found list box. P sinc obvious n't want filenam drive list box deceiv window set lparam valu search specif ~~~.~~~. P sinc odd system file call ~~~.~~~ window wonht find file name thing put drive list box drive name themselves. M after wheredlgproc process wm_initdialog messag control return window intern dialog box manag display dialog box. O the messag must react wm_command message. O thi messag sent wheredlgproc whenev event interest happen one dialog box controls. P when wm_command messag sent wparam valu contain identifi control event occur hiword lparam contain certain notif code. P In winwher 's case must take kind action one five push button click By size By date check box click select entri file type combin box. M when By size By date check box check disabl edit control three radio button control group. P thi prevent enter data edit field use mous keyboard select radio button. P moreov input focu set disabl control. P howev check one check box control control group enabl enter data edit field select one radio buttons. M To enabl disabl window use enablewindow function. P the second argument function boolean valu nonzero window enabl zero window disabled. P the code accomplish shown section A figur 4. M when item select combin box wm_command messag sent wheredlgproc hiword 1param valu set cbn_selchang notif code. P thi messag use process anoth control track current select list box combin box. P In applic current select file type combin box chang must chang content file name edit control reflect correspond file specification. P the relev code shown section B figur 4. M the main process wheredelgprog trigger click OK push botton. P At point must scan control window dialog box deriv search criterion file specif drive search option date size values. P We call wheredriv function start search operation. M wheredriv clear previou content found file list box turn redraw flag. P If flag left success string ad list box would caus complet redisplay list box. P So turn redraw flag back search process finished. M sinc search oper may take time 's best give customari visibl clue chang shape window mous pointer arrow hourglass. P To chang cursor shape hourglass back use call shown figur 4 C M findfilesindirectori function contain actual search logic. O It reli heavili inform return _dos_findfirst _dos_findnext functions. P these two function microsoft 's C languag interfac ms-do 's interrupt 21h function 4E 4f. P To search group file match certain specif must first call _dos_findfirst function. P you pa _dos_findfirst file specif string attribut bit file must poss pointer find_t structure. P the field hte find_t structur hte attribut valu shown figur 5. P If _dos_findfirst find file match specif desir attribut return valu 0 program. P the find_t structur also fill inform file. P after process first hit _dos_findnext call loop search files. P the loop termin _dos_findnext return nonzero value. P note _dos_findnext also fill find_t structur inform found files. M winwher tell _dos_findfirst _dos_findnext find normal file file attribut neither archiv bit read-onli bit set match desir file specification. P If ad size date limit search size date field find_t structur compar valu requested. O If search criterion satisfi name file ad found file list box. M after first-round search normal file _dos_findfirst _dos_findnext function call time locat match file subdirectori contain current directory. O findfilesindirectori call recurs subdirectori any. M when entir search oper done restor origin mous pointer reenabl OK push button turn redraw flag found file list box back on. P you read list box gener batch file contain command file list. M enhanc M I think 'll find winwher power tool greatli enhanc window environ especi 're kind user like stay window day long. P At first glanc I n't see much 're like want add winwher I also know user ingenu boundless feel free max features. P you may want enhanc search criterion choic do file attribut find hidden system file exampl file time exampl find file modifi past hour P you might also add second valu date size criterion could defin lower upper limit rang search valu find file 1,000 2,000 byte size exampl P but exercis left reader M marc adler head magma softwar system milburn new jersey. P He also develop mewel window system. O 
</TEXT>
</DOC>
